{% extends "base.html" %}
{% block content %}
<h3>Týždenný prehľad</h3>

<div class="row mt-4">
  <div class="col-md-8">
    <div class="card p-4">
      <h5>Hodiny zo záznamov</h5>
      <canvas id="hoursChart"></canvas>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-4">
      <h5>Výkon podľa projektu</h5>
      <ul class="list-group list-group-flush">
        {% for r in records %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ r.project.name if r.project else 'N/A' }}
          <span class="badge bg-primary rounded-pill">{{ r.amount }} {{ r.project.unit_type if r.project else '' }}</span>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<div class="row mt-4">
  <div class="col-md-3">
    <div class="card text-center p-3">
      <h6>Celkový výkon</h6>
      <h3>{{ total }}</h3>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-center p-3">
      <h6>Počet projektov</h6>
      <h3>{{ projects|length }}</h3>
    </div>
  </div>
</div>

<script>
const ctx = document.getElementById('hoursChart').getContext('2d');
new Chart(ctx, {
  type: 'bar',
  data: {
    labels: [{% for r in records %}'{{ r.date }}',{% endfor %}],
    datasets: [{
      label: 'Hodiny',
      data: [{% for r in records %}{{ r.amount }},{% endfor %}],
      backgroundColor: 'rgba(0,191,166,0.7)'
    }]
  },
  options: {
    scales: { y: { beginAtZero: true } }
  }
});
</script>
{% endblock %}
