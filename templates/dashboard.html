{% extends "base.html" %}
{% block content %}
<h2>Moje záznamy</h2>
<form action="/add_record" method="POST">
  <label>Dátum:</label><input type="date" name="date" required>
  <label>Projekt:</label>
  <select name="project_id" required>
    {% for p in projects %}
    <option value="{{ p.id }}">{{ p.name }} ({{ p.unit_type }})</option>
    {% endfor %}
  </select>
  <label>Hodnota:</label><input type="number" step="0.1" name="amount" required>
  <label>Poznámka:</label><input type="text" name="note">
  <button type="submit">Pridať</button>
</form>

<a class="pdf-btn" href="/export/pdf">📄 Export PDF</a>

<table>
  <tr><th>Dátum</th><th>Projekt</th><th>Množstvo</th><th>Poznámka</th><th>Upraviť</th></tr>
  {% for r in records %}
  <tr>
    <td>{{ r.date }}</td>
    <td>{{ r.project.name if r.project else '' }}</td>
    <td>{{ r.amount }}</td>
    <td>{{ r.note }}</td>
    <td><button onclick="openEditModal({{ r.id }}, {{ r.project_id }}, {{ r.amount }}, '{{ r.note }}')">✏️</button></td>
  </tr>
  {% endfor %}
</table>

<div id="editModal" class="modal">
  <form id="editForm" method="POST">
    <h3>Upraviť záznam</h3>
    <label>Projekt:</label>
    <select name="project_id">
      {% for p in projects %}
      <option value="{{ p.id }}">{{ p.name }}</option>
      {% endfor %}
    </select>
    <label>Množstvo:</label><input name="amount" type="number" step="0.1">
    <label>Poznámka:</label><input name="note" type="text">
    <button type="submit">Uložiť</button>
  </form>
</div>
{% endblock %}
