{% extends "layout_dark.html" %}
{% block content %}
<h3>Týždenný prehľad - {{ user.name }}</h3>

<div class="row mb-4">
  <div class="col-md-6">
    <div class="card p-3">
      <h5>Hodiny zo záznamov</h5>
      <canvas id="hoursChart" height="150"></canvas>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card p-3">
      <h5>Výkony podľa projektov</h5>
      <ul class="list-group">
        {% for r in records %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ r.project.name if r.project else 'N/A' }}
          <span>{{ r.amount }} {{ r.project.unit_type if r.project else '' }}</span>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<script>
const ctx = document.getElementById('hoursChart').getContext('2d');
new Chart(ctx, {
    type: 'bar',
    data: {
        labels: [{% for r in records %}'{{ r.date }}',{% endfor %}],
        datasets: [{
            label: 'Hodiny',
            data: [{% for r in records %}{{ r.amount }},{% endfor %}],
            backgroundColor: 'rgba(54, 162, 235, 0.7)'
        }]
    },
    options: {
        responsive: true,
        scales: { y: { beginAtZero: true } }
    }
});
</script>
{% endblock %}
