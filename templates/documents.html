{% extends "base.html" %}
{% block content %}
<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Dokumenty</h3>
    <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary">
      <i class="fa fa-arrow-left me-1"></i> Sp칛콘 na dashboard
    </a>
  </div>

  <!-- Upload sekcia -->
  <div class="card p-4 mb-4 shadow-sm" style="max-width: 600px;">
    <h5 class="mb-3">Nahra콘 nov칳 dokument</h5>
    <form method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <input type="file" name="file" class="form-control" required>
      </div>
      <button type="submit" class="btn btn-primary">
        <i class="fa fa-upload me-2"></i> Nahra콘 dokument
      </button>
    </form>
  </div>

  <!-- Zoznam dokumentov -->
  <div class="card p-4 shadow-sm">
    <h5 class="mb-3">
      {% if selected_user_name %}
        Dokumenty pou쮂셨ate쬬: <span class="text-primary">{{ selected_user_name }}</span>
      {% elif user.is_admin %}
        V코etky dokumenty
      {% else %}
        Moje dokumenty
      {% endif %}
    </h5>

{% if documents %}
<div class="table-responsive">
  <table class="table align-middle">
    <thead class="table-light">
      <tr>
        <th><i class="fa fa-file me-1"></i> N치zov s칰boru</th>

        {% if user.is_admin %}
        <th><i class="fa fa-user me-1"></i> Pou쮂셨ate</th>
        {% endif %}

        <th class="text-end">Akcie</th>
      </tr>
    </thead>

    <tbody>
      {% for doc in documents %}
      <tr>
        <!-- N치zov s칰boru -->
        <td>
          <i class="fa fa-file-alt text-primary me-2"></i>
          {{ doc.filename }}
        </td>

        <!-- Pou쮂셨ate (iba admin) -->
        {% if user.is_admin %}
        <td>
          <span class="badge bg-secondary">
            {{ doc.user_name or 'Nezn치my pou쮂셨ate' }}
          </span>
        </td>
        {% endif %}

        <!-- Akcie -->
        <td class="text-end d-flex justify-content-end gap-2">
          <!-- 游릭 Stiahnu콘 -->
          <a href="{{ url_for('uploaded_file', filename=doc.filename) }}"
             class="btn btn-outline-success btn-sm">
            <i class="fa fa-download me-1"></i> Stiahnu콘
          </a>

          <!-- 游댮 Vymaza콘 -->
          {% if user.is_admin or doc.user_id == user.id %}
          <form method="POST"
                action="{{ url_for('delete_document', document_id=doc.id, user_id=selected_user_id) }}"
                onsubmit="return confirm('Naozaj chce코 odstr치ni콘 dokument {{ doc.filename }}?');">
            <button type="submit" class="btn btn-outline-danger btn-sm">
              <i class="fa fa-trash"></i> Vymaza콘
            </button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% else %}
<p class="text-muted">
  <i class="fa fa-info-circle me-1"></i>
  Zatia nem치te 쬴adne nahran칠 dokumenty.
</p>
{% endif %}
  </div>
</div>
{% endblock %}
